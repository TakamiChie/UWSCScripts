CALL Office
MODULE Excel

  FUNCTION GETEXCEL(active=TRUE)
    RESULT = Office.GETOBJECT("Excel.Application", active)
  FEND
  
  FUNCTION CHOICEFILE()
    RESULT = Office.CHOICEFILECORE("workbooks")
  FEND
  
  PROCEDURE EACHROWS(table, callback, skipfirst = TRUE) 
    DIM r = TRUE
    FOR i = 1 TO table.rows.count
      IF skipfirst AND i = 1 THEN CONTINUE
      r = EVAL(callback + "(table.rows[i], i)")
      IF r = FALSE THEN BREAK 
    NEXT
  FEND
  
ENDMODULE
